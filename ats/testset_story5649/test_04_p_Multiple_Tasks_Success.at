# Test Case 04.

# Description:
#   Given a LITP deployment and a LITP plugin, where multiple tasks are
#   generated by the plugin, if a single model item is associated with those
#   tasks and all tasks' executions succeed, then the model item's state will
#   be set to an Applied state.
# Expected result:
#   After all the tasks' executions succeed, the model item's state is set to
#   Applied.


# Prerequisite - story5649 extension and plugin
add-extensions extensions/story5649_extension
add-plugins plugins/story5649_plugin

# 1. Create a story5649 item with many associated tasks
litp create -p /software/items/item_01 -t story5649 -o name=item_01 number_of_tasks=many

# 2. Check the state of the item before running the plan
assertState -p /software/items/item_01 Initial

# 3. Create and run the plan
litp create_plan
assertPlanState initial

litp run_plan
assertPlanState successful

# 4. Check that the state of the item is Applied and its APD flag is set
#    to True
assertState -p /software/items/item_01 Applied
assertAppliedPropertiesDeterminable -p /software/items/item_01 True
